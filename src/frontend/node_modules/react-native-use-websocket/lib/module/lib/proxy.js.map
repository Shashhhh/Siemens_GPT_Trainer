{"version":3,"sources":["proxy.ts"],"names":["websocketWrapper","webSocket","start","Proxy","get","obj","key","val","console","error","set","test","warn"],"mappings":"AAUA,OAAO,MAAMA,gBAAgB,GAAG,CAC9BC,SAD8B,EAE9BC,KAF8B,KAGhB;AAEd,SAAO,IAAIC,KAAJ,CAAqBF,SAArB,EAAgC;AACrCG,IAAAA,GAAG,EAAE,CAACC,GAAD,EAAMC,GAAN,KAA+B;AAClC,YAAMC,GAAG,GAAGF,GAAG,CAACC,GAAD,CAAf;AACA,UAAKA,GAAD,KAAiB,WAArB,EAAkC,OAAOJ,KAAP;;AAClC,UAAI,OAAOK,GAAP,KAAe,UAAnB,EAA+B;AAC7BC,QAAAA,OAAO,CAACC,KAAR,CAAc,+HAAd,EAD6B,CAG7B;;AACA,eAAO,MAAM,CAAE,CAAf;AACD,OALD,MAKO;AACL,eAAOF,GAAP;AACD;AACF,KAZoC;AAarCG,IAAAA,GAAG,EAAE,CAACL,GAAD,EAAiBC,GAAjB,EAA8CC,GAA9C,KAA2D;AAC9D,UAAI,MAAMI,IAAN,CAAWL,GAAX,CAAJ,EAAqB;AACnBE,QAAAA,OAAO,CAACI,IAAR,CAAa,wGAAb;AACA,eAAO,KAAP;AACD,OAHD,MAGO;AACLP,QAAAA,GAAG,CAACC,GAAD,CAAH,GAAWC,GAAX;AACA,eAAO,IAAP;AACD;AACF;AArBoC,GAAhC,CAAP;AAuBD,CA5BM;AA8BP,eAAeP,gBAAf","sourcesContent":["import type { MutableRefObject } from 'react';\r\n\r\ntype IfEquals<X, Y, A=X, B=never> =\r\n  (<T>() => T extends X ? 1 : 2) extends\r\n  (<T>() => T extends Y ? 1 : 2) ? A : B;\r\n\r\ntype WritableKeys<T> = {\r\n  [P in keyof T]-?: IfEquals<{ [Q in P]: T[P] }, { -readonly [Q in P]: T[P] }, P>\r\n}[keyof T];\r\n\r\nexport const websocketWrapper = (\r\n  webSocket: WebSocket,\r\n  start: MutableRefObject<() => void>,\r\n): WebSocket => {\r\n\r\n  return new Proxy<WebSocket>(webSocket, {\r\n    get: (obj, key: keyof WebSocket) => {\r\n      const val = obj[key];\r\n      if ((key as any) === 'reconnect') return start;\r\n      if (typeof val === 'function') {\r\n        console.error('Calling methods directly on the websocket is not supported at this moment. You must use the methods returned by useWebSocket.');\r\n        \r\n        //Prevent error thrown by invoking a non-function\r\n        return () => {};\r\n      } else {\r\n        return val;\r\n      }\r\n    },\r\n    set: (obj: WebSocket, key:WritableKeys<WebSocket>, val: any) => {\r\n      if (/^on/.test(key)) {\r\n        console.warn('The websocket\\'s event handlers should be defined through the options object passed into useWebSocket.')\r\n        return false;\r\n      } else {\r\n        obj[key] = val;\r\n        return true;\r\n      }\r\n    },\r\n  });\r\n};\r\n\r\nexport default websocketWrapper;\r\n"]}